geom_line(mapping = aes(x = nboots, y = exponential), color = "red") +
geom_line(mapping = aes(x = nboots, y = chisq), color = "green") +
labs(x = "Bootstrap Iterations", y = expression(paste("Type-I-Error (", alpha, ")")))
l.p[[ind[i] + 2]] = ggplot(data = dat.R.w[ind.2[i] + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = normal), color = "black") +
geom_line(mapping = aes(x = nboots, y = poisson), color = "blue") +
geom_line(mapping = aes(x = nboots, y = exponential), color = "red") +
geom_line(mapping = aes(x = nboots, y = chisq), color = "green") +
labs(x = "Bootstrap Iterations", y = expression(paste("Type-I-Error (", alpha, ")")))
l.p[[ind[i] + 3]] = ggplot(data = dat.C.w[ind.2[i] + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = normal), color = "black") +
geom_line(mapping = aes(x = nboots, y = poisson), color = "blue") +
geom_line(mapping = aes(x = nboots, y = exponential), color = "red") +
geom_line(mapping = aes(x = nboots, y = chisq), color = "green") +
labs(x = "Bootstrap Iterations", y = expression(paste("Type-I-Error (", alpha, ")")))
# l.p[[ind[i] + 4]] = ggplot(data = dat.R.npg[ind.2[i] + c(0:4),])+
#     geom_line(mapping = aes(x = nboots, y = normal), color = "black") +
#     geom_line(mapping = aes(x = nboots, y = poisson), color = "blue") +
#     geom_line(mapping = aes(x = nboots, y = exponential), color = "red") +
#     geom_line(mapping = aes(x = nboots, y = chisq), color = "green") +
#     labs(x = "Bootstrap Iterations", y = paste0("Type-I-Error (", expression(alpha), ")"))
#
# l.p[[ind[i] + 5]] = ggplot(data = dat.C.npg[ind.2[i] + c(0:4),])+
#     geom_line(mapping = aes(x = nboots, y = normal), color = "black") +
#     geom_line(mapping = aes(x = nboots, y = poisson), color = "blue") +
#     geom_line(mapping = aes(x = nboots, y = exponential), color = "red") +
#     geom_line(mapping = aes(x = nboots, y = chisq), color = "green") +
#     labs(x = "Bootstrap Iterations", y = paste0("Type-I-Error (", expression(alpha), ")"))
l.p[[ind[i] + 4]] = ggplot()+
geom_line(mapping = aes(x = time.r[ind.2[i] + c(0:4), "nboots"], y = time.r[ind.2[i] + c(0:4), 3]), color = "red") +
geom_line(mapping = aes(x = time.c[ind.2[i] + c(0:4), "nboots"], y = time.c[ind.2[i] + c(0:4), 3]), color = "blue") +
labs(x = "Bootstrap Iterations", y = "Microseconds") # on Median
}
type1_plot = do.call("grid.arrange", c(l.p, nrow = 5, ncol = 5))
ggsave("./results/plot_t1s2.pdf", plot = type1_plot, dpi = 300, width = 16, height = 9)
ts2_time_xtab_R = xtable(time.r)
ts2_time_xtab_C = xtable(time.c)
print(ts2_time_xtab_R, file = "./results/tab_ts2Time_r.tex")
print(ts2_time_xtab_C, file = "./results/tab_ts2Time_Cpp.tex")
### Power Study
dat.1 = dat.2 = dat.3 = dat.4 = dat.5 = cbind(base_grid, "R_np" = NA, "R_w" = NA, "C_np" =  NA, "C_w" = NA)
for(i in 1:nrow(base_grid)){
A.temp.1 = A.temp.2 = A.temp.3 = A.temp.4 = A.temp.5 = matrix(NA, nrow = 4, ncol = 1000)
A.temp.1[1,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.5, 1), nboot = base_grid$nboots[i])$reject)
A.temp.1[2,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.5, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
A.temp.1[3,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.5, 1), nboot = base_grid$nboots[i])$reject)
A.temp.1[4,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.5, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
# A.temp.1[5,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.5, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
# A.temp.1[6,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.5, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
#
A.temp.2[1,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.75, 1), nboot = base_grid$nboots[i])$reject)
A.temp.2[2,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.75, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
A.temp.2[3,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.75, 1), nboot = base_grid$nboots[i])$reject)
A.temp.2[4,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.75, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
# A.temp.2[5,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.75, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
# A.temp.2[6,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 0.75, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
#
A.temp.3[1,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1, 1), nboot = base_grid$nboots[i])$reject)
A.temp.3[2,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
A.temp.3[3,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1, 1), nboot = base_grid$nboots[i])$reject)
A.temp.3[4,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
# A.temp.3[5,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
# A.temp.3[6,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
#
A.temp.4[1,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.25, 1), nboot = base_grid$nboots[i])$reject)
A.temp.4[2,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.25, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
A.temp.4[3,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.25, 1), nboot = base_grid$nboots[i])$reject)
A.temp.4[4,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.25, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
# A.temp.4[5,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.25, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
# A.temp.4[6,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.25, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
#
A.temp.5[1,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.5, 1), nboot = base_grid$nboots[i])$reject)
A.temp.5[2,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.5, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
A.temp.5[3,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.5, 1), nboot = base_grid$nboots[i])$reject)
A.temp.5[4,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.5, 1), nboot = base_grid$nboots[i], boot.type = "wild")$reject)
# A.temp.5[5,] = replicate(1000, t.testBoot(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.5, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
# A.temp.5[6,] = replicate(1000, t.testBoot.cpp(rnorm(base_grid$n[i], 0, 1), rnorm(base_grid$n[i], 1.5, 1), nboot = base_grid$nboots[i], boot.type = "npg")$reject)
#
dat.1[i, c(3:6)] = rowMeans(A.temp.1)
dat.2[i, c(3:6)] = rowMeans(A.temp.2)
dat.3[i, c(3:6)] = rowMeans(A.temp.3)
dat.4[i, c(3:6)] = rowMeans(A.temp.4)
dat.5[i, c(3:6)] = rowMeans(A.temp.5)
}
l.p = list()
for(i in seq(1, nrow(base_grid), 5)){
l.p[[i]] = ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 1]] = ggplot(data = dat.2[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 2]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 2]] = ggplot(data = dat.3[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 3]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 3]] = ggplot(data = dat.4[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 4]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 4]] = ggplot(data = dat.5[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 5]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
}
type2_plot = do.call("grid.arrange", c(l.p, nrow = 5, ncol = 5))
ggsave("./results/plot_t2s2.pdf", plot = type2_plot, dpi = 300, width = 16, height = 9)
save(file = "./results/ts2_data.RData", type1_plot, dat.R.np, dat.C.np, dat.R.npg, dat.C.npg, dat.R.w, dat.C.w, time.r, time.c, dat.1, dat.2, dat.3, dat.4, dat.5, type2_plot)
View(pow.true.1)
i = 1
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
ggplot(data = dat.2[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 2]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
ggplot(data = dat.3[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 3]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
ggplot(data = dat.4[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 4]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
ggplot(data = dat.5[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 5]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
i = 2
i = 6
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
pow.true.1
mean(t.power.fun(replicate(1000, t.test(rnorm(50), 1, 1)$p.value)))
mean(t.power.fun(replicate(1000, t.test(rnorm(50, 1, 1))$p.value)))
mean(t.power.fun(replicate(1000, t.test(rnorm(50, 0.75, 1))$p.value)))
mean(t.power.fun(replicate(1000, t.test(rnorm(50, 0.5, 1))$p.value)))
mean(t.power.fun(replicate(1000, t.test(rnorm(10, 0.5, 1))$p.value)))
mean(t.power.fun(replicate(1000, t.test(rnorm(10, 0.75, 1))$p.value)))
mean(t.power.fun(replicate(1000, t.test(rnorm(10, 1, 1))$p.value)))
i
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
pow.true.1[i + c(0:4), 1])
pow.true.1[i + c(0:4), 1]
i = 11
pow.true.1[i + c(0:4), 1]
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.1[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
ggplot(data = dat.2[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 2]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
type2_plot
do.call("grid.arrange", c(l.p, nrow = 5, ncol = 5))
a = numeric(10)
a[c(1:5)] = 3
a
for(i in seq(1, nrow(base_grid), 5)){#1:nrow(base_grid)){
pow.true.1[i + c(0:4),1] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 0.5, 1))$p.value)))
pow.true.1[i + c(0:4),2] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 0.75, 1))$p.value)))
pow.true.1[i + c(0:4),3] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 1, 1))$p.value)))
pow.true.1[i + c(0:4),4] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 1.25, 1))$p.value)))
pow.true.1[i + c(0:4),5] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 1.5, 1))$p.value)))
pow.true.2[i + c(0:4),1] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 0.5, 1), rnorm(base_grid$n[i]))$p.value)))
pow.true.2[i + c(0:4),2] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 0.75, 1), rnorm(base_grid$n[i]))$p.value)))
pow.true.2[i + c(0:4),3] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 1, 1), rnorm(base_grid$n[i]))$p.value)))
pow.true.2[i + c(0:4),4] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 1.25, 1), rnorm(base_grid$n[i]))$p.value)))
pow.true.2[i + c(0:4),5] = mean(t.power.fun(replicate(1000, t.test(rnorm(base_grid$n[i], 1.5, 1), rnorm(base_grid$n[i]))$p.value)))
}
pow.true.1
pow.true.2
l.p = list()
for(i in seq(1, nrow(base_grid), 5)){
l.p[[i]] = ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 1]] = ggplot(data = dat.2[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 2]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 2]] = ggplot(data = dat.3[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 3]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 3]] = ggplot(data = dat.4[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 4]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 4]] = ggplot(data = dat.5[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 5]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
}
type2_plot = do.call("grid.arrange", c(l.p, nrow = 5, ncol = 5))
ggsave("./results/plot_t2s2.pdf", plot = type2_plot, dpi = 300, width = 16, height = 9)
i = 1
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
print(l.p[1])
print(l.p[2])
print(l.p[3])
print(l.p[4])
print(l.p[5])
print(l.p[6])
print(l.p[7])
print(l.p[11])
i = 11
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p = list()
for(i in seq(1, nrow(base_grid), 5)){
l.p[i] = ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 1]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[i + 1] = ggplot(data = dat.2[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 2]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[i + 2] = ggplot(data = dat.3[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 3]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[i + 3] = ggplot(data = dat.4[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 4]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[i + 4] = ggplot(data = dat.5[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = base_grid$nboots[i + c(0:4)], y = pow.true.2[i + c(0:4), 5]), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
}
type2_plot = do.call("grid.arrange", c(l.p, nrow = 5, ncol = 5))
ggsave("./results/plot_t2s2.pdf", plot = type2_plot, dpi = 300, width = 16, height = 9)
l.p
l.p = list()
dat.1
dat.2
dat.3
dat.4
pow.1.true
pow.true.1
dat.1 = cbind(dat.1, true = pow.true.1[,1])
dat.1
dat.1$true = pow.true.2[,1]
dat.1
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
i
i = 1
ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p = list()
for(i in seq(1, nrow(base_grid), 5)){
l.p[[i]] = ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 1]] = ggplot(data = dat.2[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 2]] = ggplot(data = dat.3[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 3]] = ggplot(data = dat.4[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 4]] = ggplot(data = dat.5[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
}
type2_plot = do.call("grid.arrange", c(l.p, nrow = 5, ncol = 5))
ggsave("./results/plot_t2s2.pdf", plot = type2_plot, dpi = 300, width = 16, height = 9)
dat.1
dat.2
dat.1$true = pow.true.2[,1]
dat.2$true = pow.true.2[,2]
dat.3$true = pow.true.2[,3]
dat.4$true = pow.true.2[,4]
dat.5$true = pow.true.2[,5]
l.p = list()
for(i in seq(1, nrow(base_grid), 5)){
l.p[[i]] = ggplot(data = dat.1[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 1]] = ggplot(data = dat.2[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 2]] = ggplot(data = dat.3[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 3]] = ggplot(data = dat.4[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
l.p[[i + 4]] = ggplot(data = dat.5[i + c(0:4),])+
geom_line(mapping = aes(x = nboots, y = R_np), color = "black") +
geom_line(mapping = aes(x = nboots, y = R_w), color = "blue") +
geom_line(mapping = aes(x = nboots, y = C_np), color = "red") +
geom_line(mapping = aes(x = nboots, y = C_w), color = "green") +
# geom_line(mapping = aes(x = nboots, y = C_npg), color = "orange") +
# geom_line(mapping = aes(x = nboots, y = R_npg), color = "purple") +
geom_line(mapping = aes(x = nboots, y = true), linetype = "dashed", color = "chocolate3") +
labs(x = "Bootstrap Iterations", y = expression(paste("Power (1 - ", beta, ")")))
}
type2_plot = do.call("grid.arrange", c(l.p, nrow = 5, ncol = 5))
ggsave("./results/plot_t2s2.pdf", plot = type2_plot, dpi = 300, width = 16, height = 9)
